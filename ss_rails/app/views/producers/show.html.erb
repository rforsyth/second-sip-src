<%
  notes_tab_selected = (params[:tab] == 'notes')
%>

<%= render :partial => 'common/global/content_header',
           :locals => { :title => @producer.name,
                        :visibility => @producer.visibility } %>

<% if @producer.website_url -%>
  <div class="details_row">
    <span class="label">Website:</span>
    <span class="content"><%= link_to @producer.website_url, @producer.website_url, :target => '_blank' -%></span>
  </div>
<% end %>
<% if @producer.cases_per_year.present? -%>
  <div class="details_row">
    <span class="label">Cases / Year:</span>
    <span class="content"><%= number_with_delimiter(@producer.cases_per_year) %></span>
  </div>
<% end %>

<% if @producer.description.present? %>
  <div class="details_notes clearfix">
    <div class="details_row">
      <span class="label">Notes:</span>
      <span class="content"><%= simple_format(@producer.description) %> </span></div>
  </div>
<% end %>

<%= render :partial => 'common/global/subnav', 
           :locals => { :tabs => [UI::NavigationTab.new(:producer_products, !notes_tab_selected ? 'selected' : nil, @producer),
                                  UI::NavigationTab.new(:producer_notes, notes_tab_selected ? 'selected' : nil, @producer)] }  %>

<% if notes_tab_selected %>
  <% if @notes.present? %>
    <div class="main_list">
      <%= render :partial => 'notes/note', :collection => @notes %>
    </div>
    <%= render :partial => 'common/lists/paging_bar' %>
  <% else %>
    <%= render :partial => 'common/global/simple_message',
               :object => "No notes to display." %>
  <% end %>
<% else %>
  <% if @products.present? %>
    <div class="main_list">
      <%= render :partial => 'products/product', :collection => @products %>
    </div>
    <%= render :partial => 'common/lists/paging_bar' %>
  <% else %>
    <%= render :partial => 'common/global/simple_message',
               :object => "No #{@product_class.name.titleize.pluralize.downcase} to display." %>
  <% end %>
<% end %>

<% if allow_edit?(@producer) %>
  <%= render :partial => 'common/edit/edit_actions',
             :locals => { :edit_path => edit_polymorphic_path([@producer.owner, @producer]),
                          :delete_path => polymorphic_path([@producer.owner, @producer]) } %>
<% end %>

<% content_for :right do %>
  <%= render :partial => 'common/edit/edit_user_tags',
             :locals => { :tag_container => @producer } %>
  <%= render :partial => 'common/edit/edit_admin_tags',
             :locals => { :tag_container => @producer } %>
<% end %>


